<h2>{{ data.deadline ? "Módosítás" : "Hozzáadás" }}</h2>
<form [formGroup]="form">
  <mat-form-field>
    <input matInput placeholder="Határidő" [matDatepicker]="picker" formControlName="date" />
    <mat-datepicker-toggle matSuffix [for]="picker" />
    <mat-datepicker #picker />
    @if (date.hasError("required")) {
      <mat-error>Dátum megadása kötelező</mat-error>
    }
  </mat-form-field>

  <mat-form-field>
    <mat-label>Típus</mat-label>
    <mat-select formControlName="type">
      @for (key of examTypeKeys; track $index) {
        <mat-option [value]="key">{{ examTypes[key] }}</mat-option>
      }
    </mat-select>
    @if (type.hasError("required")) {
      <mat-error>Típus megadása kötelező</mat-error>
    }
  </mat-form-field>

  <mat-form-field>
    <mat-label>Tárgy</mat-label>
    <input matInput type="text" formControlName="subject" />
    @if (subject.hasError("required")) {
      <mat-error>Tárgy megadása kötelező</mat-error>
    }
  </mat-form-field>

  <mat-form-field>
    <mat-label>Megjegyzés</mat-label>
    <textarea matInput formControlName="comments"></textarea>
  </mat-form-field>

  <mat-label>Súlyosság</mat-label>
  <mat-slider min="1" max="5" step="1">
    <input matInput matSliderThumb formControlName="severity" />
  </mat-slider>
  <span>{{ severity.value }}</span>

  <mat-radio-group formControlName="isPersonal">
    <mat-radio-button title="Közös" [value]="false">Közös</mat-radio-button>
    <mat-radio-button title="Személyes" [value]="true">Személyes</mat-radio-button>
  </mat-radio-group>
  @if (isPersonal.hasError("required") && isPersonal.touched) {
    <mat-error>Láthatóság megadása kötelező</mat-error>
  }

  <mat-checkbox formControlName="isCompleted">Teljesítve?</mat-checkbox>

  <div class="actions">
    <button class="btn" [disabled]="submitting" (click)="submit()">{{ data.deadline ? "Mentés" : "Hozzáadás" }}</button>
    <button class="btn" [mat-dialog-close]="undefined">Mégsem</button>
  </div>
</form>
@if (submitting) {
  <div class="overlay">
    <mat-spinner />
  </div>
}
